<!DOCTYPE html>
<html lang="yes">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Responsive Canvas Layout (2-State)</title>
    <style>
        /* Basic Reset and Fullscreen Setup */
        body, html {
            margin: 0;
            padding: 0;
            width: 100vw;
            height: 100vh;
            overflow: hidden; /* Prevent scrollbars from window itself */
            font-family: Arial, sans-serif;
            background-color: #D2B48C; /* Retro Tan Background */
        }

        /* Grid Container Setup */
        #grid-container {
            display: grid;
            width: 100%;
            height: 100%;
            gap: 8px; /* Gap between grid items */
            padding: 8px; /* Padding around the grid container */
            box-sizing: border-box;
        }

        /* Common Styles for Grid Items (Menu, Board, Bench Divs) */
        .grid-item {
            padding: 8px; /* Padding inside each grid item */
            box-sizing: border-box;
            overflow: hidden; /* Ensure canvas doesn't overflow padding */
            border-radius: 6px; /* Rounded corners for items */
            display: flex; /* To help center canvas or content if needed */
            flex-direction: column; /* Default for content stacking */
            justify-content: center; /* Center content vertically */
            align-items: center; /* Center content horizontally */
            background-color: #D2B48C; /* Retro Tan Background */
        }

        /* Specific Item Styling */
        #menu-item {
            display: flex;
            flex-direction: row; /* Arrange icons horizontally */
            justify-content: space-around; /* Space icons equally */
            align-items: center;
            padding: 0 15px; /* Add some horizontal padding for icons */
        }

        #menu-item img {
            height: 70%; /* Adjust icon size relative to menu height */
            width: auto;
            max-width: 23%; /* Ensure icons don't overflow */
        }

        #board-item, .bench-item {
            border: 8px solid #FFFFFF; /* Wide white border */
            border-radius: 20px; /* Wide radius for the border */
        }
        
        /* Canvas Styling */
        canvas {
            display: block;
            width: 100%;
            height: 100%;
            background-color: rgba(255, 255, 255, 0.15); /* Slightly transparent white */
            border-radius: 3px; /* Slightly rounded corners for canvas */
        }

        /* Layout 1: Tall (Aspect Ratio < 1.0) - 5 full-width divs stacked vertically */
        .layout-tall {
            /* Menu (short), Board (squarish), Bench, Bench, Bench */
            grid-template-rows: 0.5fr 3fr 0.5fr 0.5fr 0.5fr; 
            grid-template-columns: 1fr;    /* Single column */
        }
        .layout-tall #menu-item    { grid-row: 1; grid-column: 1; }
        .layout-tall #board-item   { grid-row: 2; grid-column: 1; }
        .layout-tall #bench1-div   { grid-row: 3; grid-column: 1; }
        .layout-tall #bench2-div   { grid-row: 4; grid-column: 1; }
        .layout-tall #bench3-div   { grid-row: 5; grid-column: 1; }


        /* Layout 2: Wide (Aspect Ratio >= 1.0) - 5 full-height divs arranged horizontally */
        .layout-wide {
            /* Menu (narrow), Board (squarish), Bench, Bench, Bench */
            grid-template-columns: 0.3fr 3fr 0.5fr 0.51fr 0.5fr; 
            grid-template-rows: 1fr; /* Single row */
        }
        .layout-wide #menu-item    { grid-row: 1; grid-column: 1; }
        .layout-wide #board-item   { grid-row: 1; grid-column: 2; }
        .layout-wide #bench1-div   { grid-row: 1; grid-column: 3; }
        .layout-wide #bench2-div   { grid-row: 1; grid-column: 4; }
        .layout-wide #bench3-div   { grid-row: 1; grid-column: 5; }

    </style>
</head>
<body>

    <div id="grid-container">
        <div id="menu-item" class="grid-item" data-name="Menu Area">
            <img src="/images/concede_icon.png" alt="Concede">
            <img src="/images/new_game_icon.png" alt="New Game">
            <img src="/images/rules_icon.png" alt="Rules">
            <img src="/images/chat_icon.png" alt="Chat">
        </div>

        <div id="board-item" class="grid-item" data-name="Board Area">
            <canvas id="board-canvas"></canvas>
        </div>

        <div id="bench1-div" class="grid-item bench-item" data-name="Bench Item 1">
            <canvas id="bench1-canvas"></canvas>
        </div>
        <div id="bench2-div" class="grid-item bench-item" data-name="Bench Item 2">
            <canvas id="bench2-canvas"></canvas>
        </div>
        <div id="bench3-div" class="grid-item bench-item" data-name="Bench Item 3">
            <canvas id="bench3-canvas"></canvas>
        </div>
    </div>

    <script>
        /**
         * Sets the canvas drawing surface size to its displayed size (CSS pixels).
         * @param {HTMLCanvasElement} canvasElement The canvas element to size.
         */
        function sizeCanvas(canvasElement) {
            if (!canvasElement) {
                console.error("sizeCanvas: Provided canvasElement is null or undefined.");
                return;
            }
            canvasElement.width = canvasElement.clientWidth;
            canvasElement.height = canvasElement.clientHeight;

            if (canvasElement.width === 0 || canvasElement.height === 0) {
                console.warn(`Canvas ${canvasElement.id || 'unnamed'} has zero dimension, skipping sizing.`);
                return;
            }
            const parentDiv = canvasElement.parentElement;
            const name = canvasElement.id || (parentDiv ? parentDiv.dataset.name : 'Unnamed Canvas');
            console.log(`Sized: ${name}, Dimensions: (${canvasElement.width.toFixed(2)}, ${canvasElement.height.toFixed(2)})`);
        }

        /**
         * Resizes all canvas elements in the document.
         */
        function resizeAllCanvases() {
            document.querySelectorAll('canvas').forEach(canvas => {
                if (canvas.offsetParent !== null && canvas.clientWidth > 0 && canvas.clientHeight > 0) {
                    sizeCanvas(canvas);
                }
            });
        }

        /**
         * Updates the layout class on the grid container based on window aspect ratio
         * and then triggers a resize of all canvases.
         */
        function updateLayoutAndSize() {
            const container = document.getElementById('grid-container');
            if (!container) {
                console.error("Grid container not found.");
                return;
            }

            const aspectRatio = window.innerWidth / window.innerHeight;
            const threshold = 1.0; // If width < height (aspect < 1.0), it's "tall"

            container.classList.remove('layout-tall', 'layout-wide');

            let newLayoutClass = '';
            if (aspectRatio < threshold) { 
                newLayoutClass = 'layout-tall';
            } else { 
                newLayoutClass = 'layout-wide';
            }
            container.classList.add(newLayoutClass);
            console.log(`Applied layout: ${newLayoutClass} (Aspect Ratio: ${aspectRatio.toFixed(2)})`);

            // Use requestAnimationFrame to ensure sizing happens after layout is applied
            requestAnimationFrame(resizeAllCanvases);
        }

        document.addEventListener('DOMContentLoaded', () => {
            console.log("DOM fully loaded and parsed.");
            updateLayoutAndSize(); 
            window.addEventListener('resize', updateLayoutAndSize);
        });
    </script>

</body>
</html>